# 批量转账工具需求说明

## 功能需求

### 1. 钱包连接
- 支持 MetaMask 钱包连接
- 自动检测并切换到 DFC Chain 网络
- 显示当前连接的钱包地址
- 监听钱包账户变化

### 2. 地址管理
- 支持批量导入地址和金额
- 支持多种格式的地址输入（空格分隔、换行分隔、逗号分隔）
- 自动格式化和验证地址格式
- 保持地址输入时的序号连续性
- 支持追加新地址而不清除现有地址

### 3. 转账功能
- 支持 ERC20 代币批量转账
- 自动分批处理（每批200个地址）
- 显示每批次的转账状态
- 显示总转账进度
- 支持转账失败时的错误提示

### 4. 界面展示
- 显示代币余额
- 显示总转账金额
- 显示批次处理进度
- 显示 Gas 消耗统计
- 显示每个批次的详细信息

### 5. 安全性
- 地址格式验证
- 金额格式验证
- 余额充足性检查
- 授权额度检查 

你似乎没理解我们的核心功能
我们根据用户给的代币合约地址，帮助用户给用户输入的地址和金额提交给批量转账合约，执行指定代币的批量转账
DFC是收取的gas费
那么一个完整的逻辑就应该有两个代币的转账
同时小狐狸钱包应该收到两个代币的转账的请求
 一个是批量转账合约的请求，请求用户授权转账的代币金额上限为用户输入地址的金额相加
 一个是本次转账手续费，DFC的转账请求
目前的情况是，每次转账小狐狸只收到一个请求，DFC的转账请求

我想问题应该出在批量转账合约，这样我们从写一个批量转账合约，同时我们梳理下业务逻辑
用户在对话框输入ERC20代币合约
网站显示余额
用户在对话框输入需要转账的地址和金额
网站请求小狐狸钱包发起ERC20的转账，到合约地址
发起dfc的转账到合约地址

合约根据用户提供的地址和金额进行批量转账

新增需求：
当用户发起交易并形成批次后，当某个批次被中断，
首先分析中断的原因，然后给用户提示，在后面添加按键，让用户选择是否继续
如果用户选择继续，则继续执行批次
如果用户选择中断，则中断批次


顶部统计信息模块
问题：
统计信息（总地址数、总批次数）的排版显得较单薄，缺乏层次感和视觉冲击。
圆形进度条的"0%"字体较小，完成度信息不够直观。
优化建议：
圆形进度条优化：
增加渐变色填充效果（从浅紫到深紫），体现进度完成的动态感。
将百分比数字加大，突出"0%"或完成状态。
在圆环下方增加"当前进度"描述，说明进度的含义，例如"批次 1/3"。
统计信息排版改进：
将"总地址数"和"总批次数"并排居中对齐，标题用小字，数字用大字突出（如 570）。
为数字增加一个浅紫色的背景圆角框或分隔线，视觉更干净。
2. 批次状态卡片
问题：
状态（COMPLETED、PENDING、FAILED）显示不够显眼。
卡片信息排列较为分散，用户需要反复查看多个字段。
"错误信息"模块占用过大空间，显得突兀。
优化建议：
状态标签设计：

将状态标签移到卡片顶部右侧，使用更醒目的颜色：
COMPLETED：绿色，带渐变色背景。
PENDING：黄色，带闪烁动画，提示状态未完成。
FAILED：红色，带轻微晃动动画，增强错误警示效果。
状态标签字体加粗，宽度稍微加长，填充感更强。
卡片内容布局优化：

将"总地址数"和"总金额"并排显示，整体靠左对齐：
复制代码
总地址数：200      总金额：206421862.0 DYW
字段用 浅灰色小标题+ 高亮数字 的方式显示，突出重点信息。
减少字段间的空白区域，让信息更紧凑。
错误信息模块：

使用红色边框突出错误框，避免占用过多卡片空间：
错误信息缩小为提示条样式，例如：
复制代码
❌ 交易执行失败，请检查网络连接或余额是否充足。
3. 交互设计
动态效果：
为"PENDING"状态增加动态加载的动画条，让用户感知到系统正在处理。
在"COMPLETED"状态下添加勾选图标，让结果完成后更明确。
按钮优化：
顶部的"导出记录"按钮：
改为圆角按钮，增加悬停渐变效果（如从浅紫到亮蓝渐变）。
增加下载图标，提升功能直观性。
错误反馈：
点击"终止"按钮后弹出确认框，避免用户误操作。
4. 视觉风格
整体背景：
当前深蓝色背景很好，但可以加入轻微的渐变（如从深蓝到黑灰），让背景层次更分明。
卡片样式：
增加卡片阴影和边框光效，增强悬浮感。
卡片边框颜色与状态标签颜色相呼应，例如 COMPLETED 卡片边框用绿色。

再发起一新的转账按键往下移动，地址框也往下移动一点，底部高度不变
修改批次统计触发逻辑，现在是用户授权后才生成，才一次性生成所有批次，改为用户在地址栏输入地址够200个就出发生成，


1."已完成"提示与completed重复了，去掉中文已完成
2 .去掉完成状态下的"复制地址"功能
3.优化UX，执行中的时候，让"completed"呈现从左到右亮度变化的效果，使用朋克风格的渐变色
4.意外中断时，"复制地址"颜色闪烁
5.底部弹出的提示，加长停留时间，3秒，增减逐渐消失效果

我给你全部转账业务逻辑有两个情况
一.强逻辑成功状态
1.用户输入完地址以后，点击执行批量交易，右边弹出批次栏，同时激活小狐狸转账业务
  -地址栏从此锁定，用户不能输入地址，直到所有业务完成，或者用户主动点击清除数据
  -当前转账业务批次状态跟新为"执行中"
    -后续批次状态栏显示"等待中"
2.如果转账成功，则当前批次状态栏显示"完成"，并显示hash值，并添加点击后连接到区块链浏览器查看交易详情功能
同时激活下个批次的交易，依次完成本轮所有批次
3.以上业务逻辑在代码中定义为强逻辑，用户不能主动终止，其他逻辑都是弱逻辑，不能和强逻辑冲突
如果冲突，则强逻辑优先同时反馈给我
二.失败状态处理
1. 当任何批次交易失败时：
   - 立即终止所有后续批次交易
   - 在屏幕右上方（MetaMask钱包下方）显示错误提示信息
   - "执行批量交易"按钮文字更改为"清空数据"
   - 当前失败批次状态更新为"失败"
   - 后续未执行批次状态更新为"已终止"

2. 用户响应：
   - 用户可以点击"清空数据"按钮
   - 点击后系统将：
     * 刷新页面
     * 清除所有已输入数据
     * 重置界面至初始状态

3. 数据展示：
   - 失败发生后，所有已输入的地址信息保持可见
   - 已完成的交易保持其状态和hash显示
   - 失败的交易显示具体错误原因

   关于地址录入
   1. 支持空格分隔的地址和金额
   2. 支持逗号分隔的地址和金额
   3. 支持换行分隔的地址和金额
   4. 支持粘贴的地址和金额
   5.序号为1开始，自动生成，且序号和地址之间有空格
   -不允许用户手动输入序号
   -字体还有颜色和后面的地址做出区分
   6.地址栏始终保持在底部
   保持光标在新的一行
只锁定序号部分，允许用户修改地址和金额
确保滚动位置总是显示最新输入的地方